(()=>{"use strict";var e={n:n=>{var t=n&&n.__esModule?()=>n.default:()=>n;return e.d(t,{a:t}),t},d:(n,t)=>{for(var a in t)e.o(t,a)&&!e.o(n,a)&&Object.defineProperty(n,a,{enumerable:!0,get:t[a]})},o:(e,n)=>Object.prototype.hasOwnProperty.call(e,n),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};e.r(n),e.d(n,{default:()=>d});var t={};e.r(t),e.d(t,{Component:()=>l,settings:()=>s});const a=require("fs");var i=e.n(a);const r={product:"gONOQ",lookText:"Bn1NG",maincontainers:"eXEUf",bundlings:"lrM6Q",bundles:"MMJNd",bundle1:"Xw8BJ",bundle2:"qaLKB",bundle3:"zzLsR",bundlingoutfits:"_GHEH",btn:"SUgml",modal:"dZ7I_",fadeIn:"zb8ud",modalContent:"LYzKO",scaleIn:"mZk4U",formGroup:"h6W7I",input:"LLpaI",select:"x16sB",modalActions:"heSoP",confirmBtn:"cCASC",cancelBtn:"xP_1t",price:"q7Ot2",effectivePrice:"mcMu9"};function o({product:e,fpi:n}){const[t,o]=(0,a.useState)(!1),[c,l]=(0,a.useState)(!1),[s,d]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),[p,_]=(0,a.useState)([]),[y,g]=(0,a.useState)(null),f="\n        query locality($locality: LocalityEnum!, $localityValue: String!, $country: String) {\n            locality(locality: $locality, localityValue: $localityValue, country: $country) {\n                display_name\n                id\n                name\n                parent_ids\n                type\n                localities {\n                    id\n                    name\n                    display_name\n                    parent_ids\n                    type\n                }\n            }\n        }\n    ";i().useEffect((()=>{_(["XS","S","M","L","XL","OS"]),m("OS")}),[]);const b=async(n,t)=>{try{const a={batch:[{context:{library:{name:"flick",version:"1.0.4"},os:{name:navigator.platform.includes("Mac")?"Mac OS":"Windows",version:"10.15.7"},timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,screen:{width:window.screen.width,height:window.screen.height},user_agent:navigator.userAgent,locale:navigator.language,device:{is_mobile:/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}},event_id:v(),event_name:"add_to_cart",properties:{cart_id:n.id,event_type:"engagement",product_id:e.uid||parseInt(e.slug.split("-").pop()),article_id:t.article_id,brand:e.brand?.name||"Generic",l3_category:e.categories?.[0]?.name||"Unknown",currency:"INR",quantity:1,position:null,query:null,f_medium:"",f_source:"",f_campaign:"",utm_medium:"",utm_source:"",utm_campaign:"",search_id:null,previous_cart_id:n.id},event_timestamp:(new Date).toISOString(),user_id:null,anonymous_id:v()}],sent_at:(new Date).toISOString()};await fetch("/api/service/application/webhook/v1.0/click-analytics/events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})}catch(e){console.error("Analytics event failed:",e)}},v=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const n=16*Math.random()|0;return("x"===e?n:3&n|8).toString(16)}));return i().createElement("div",{className:r.product},e.media?.[0]&&i().createElement("img",{src:e.media[0].url,alt:e.media[0].alt}),i().createElement("h1",{className:r.name},e.name),e.price&&i().createElement("div",{className:r.price},i().createElement("span",{className:r.effectivePrice},e.price.effective?.currency_symbol,e.price.effective?.min),e.price.effective?.max!==e.price.effective?.min&&i().createElement("span",null," - ",e.price.effective?.currency_symbol,e.price.effective?.max)),i().createElement("button",{className:r.btn,onClick:()=>{l(!0)},disabled:t},t?"Adding...":"Add to Cart"),c&&i().createElement("div",{className:r.modal},i().createElement("div",{className:r.modalContent},i().createElement("h3",null,"Check Serviceability"),i().createElement("div",{className:r.formGroup},i().createElement("label",null,"Pincode:"),i().createElement("input",{type:"text",value:s,onChange:e=>d(e.target.value),placeholder:"Enter 6-digit pincode (e.g., 400001)",className:r.input,maxLength:"6"})),i().createElement("div",{className:r.formGroup},i().createElement("label",null,"Size:"),i().createElement("select",{value:u,onChange:e=>m(e.target.value),className:r.select},p.map((e=>i().createElement("option",{key:e,value:e},e))))),i().createElement("div",{className:r.modalActions},i().createElement("button",{onClick:async()=>{if(!s||!u)return void alert("Please enter pincode and select size");const t=s.replace(/\D/g,"");if(6===t.length)try{let a,i;o(!0),console.log("Debug Info:",{pincode:t,selectedSize:u,productSlug:e.slug,productUid:e.uid}),console.log("Step 1: Checking locality...");const r=[{country:"IN",query:f},{country:"IND",query:f},{country:null,query:"\n        query locality($locality: LocalityEnum!, $localityValue: String!) {\n            locality(locality: $locality, localityValue: $localityValue) {\n                display_name\n                id\n                name\n                parent_ids\n                type\n                localities {\n                    id\n                    name\n                    display_name\n                    parent_ids\n                    type\n                }\n            }\n        }\n    "}];for(const e of r)try{console.log("Trying approach:",e);const r={locality:"pincode",localityValue:t};if(e.country&&(r.country=e.country),a=await n.executeGQL(e.query,r),console.log("Result:",a),i=a?.data?.locality||a?.locality,i&&!a?.errors){console.log("✅ Success with approach:",e);break}a?.errors&&console.log("❌ Error with approach:",e,a.errors)}catch(n){console.log("❌ Exception with approach:",e,n.message);continue}if(!i)return console.error("All locality approaches failed"),a?.errors?alert(`Locality Error: ${a.errors[0]?.message||"Unknown error"}`):alert("Invalid pincode or locality service unavailable"),void o(!1);console.log("✅ Locality validated successfully:",i),console.log("Step 2: Checking product price...");const c=await n.executeGQL("\n        query ProductPrice($slug: String!, $size: String!, $pincode: String!) {\n            productPrice(slug: $slug, size: $size, pincode: $pincode) {\n                article_id\n                discount\n                is_cod\n                is_gift\n                item_type\n                long_lat\n                pincode\n                quantity\n                seller_count\n                special_badge\n                price_per_piece {\n                    currency_code\n                    currency_symbol\n                    effective\n                    marked\n                    selling\n                }\n                price {\n                    currency_code\n                    currency_symbol\n                    effective\n                    marked\n                    selling\n                }\n                price_per_unit {\n                    currency_code\n                    currency_symbol\n                    price\n                    unit\n                }\n                return_config {\n                    returnable\n                    time\n                    unit\n                }\n                seller {\n                    count\n                    name\n                    uid\n                }\n                set {\n                    quantity\n                }\n                store {\n                    uid\n                    name\n                    count\n                }\n                strategy_wise_listing {\n                    distance\n                    pincode\n                    quantity\n                    tat\n                }\n                grouped_attributes {\n                    title\n                    details {\n                        key\n                        type\n                        value\n                    }\n                }\n                article_assignment {\n                    level\n                    strategy\n                }\n                delivery_promise {\n                    max\n                    min\n                }\n                discount_meta {\n                    end\n                    start\n                    start_timer_in_minutes\n                    timer\n                }\n            }\n        }\n    ",{slug:e.slug,size:u,pincode:t});console.log("Price Result:",c);const s=c?.data?.productPrice||c?.productPrice;if(!s)return console.error("No price data found"),c?.errors?alert(`Product Price Error: ${c.errors[0]?.message||"Unknown error"}`):alert("Product not available for this pincode and size combination"),void o(!1);console.log("✅ Product price validated successfully:",s),g(s),await(async(t,a)=>{try{console.log("Step 3: Adding to cart...");const i=e.uid||parseInt(e.slug.split("-").pop());console.log("Cart Item Details:",{itemId:i,articleId:t.article_id,sellerId:t.seller.uid,storeId:t.store.uid,size:u,pincode:a});const r=await n.executeGQL("\n        mutation AddItemsToCart($buyNow: Boolean, $areaCode: String!, $addCartRequestInput: AddCartRequestInput) {\n            addItemsToCart(buyNow: $buyNow, areaCode: $areaCode, addCartRequestInput: $addCartRequestInput) {\n                message\n                partial\n                success\n                cart {\n                    buy_now\n                    cart_id\n                    checkout_mode\n                    comment\n                    coupon_text\n                    delivery_charge_info\n                    gstin\n                    id\n                    is_valid\n                    message\n                    restrict_checkout\n                    user_cart_items_count\n                    uid\n                    items {\n                        bulk_offer\n                        coupon_message\n                        custom_order\n                        discount\n                        is_set\n                        key\n                        message\n                        moq\n                        parent_item_identifiers\n                        product_ean_id\n                        quantity\n                        availability {\n                            deliverable\n                            is_valid\n                            other_store_quantity\n                            out_of_stock\n                            sizes\n                            available_sizes {\n                                display\n                                is_available\n                                value\n                            }\n                        }\n                        article {\n                            _custom_json\n                            cart_item_meta\n                            extra_meta\n                            gift_card\n                            identifier\n                            is_gift_visible\n                            meta\n                            mto_quantity\n                            parent_item_identifiers\n                            product_group_tags\n                            quantity\n                            seller_identifier\n                            size\n                            tags\n                            uid\n                            seller {\n                                name\n                                uid\n                            }\n                            price {\n                                base {\n                                    currency_code\n                                    currency_symbol\n                                    effective\n                                    marked\n                                }\n                                converted {\n                                    currency_code\n                                    currency_symbol\n                                    effective\n                                    marked\n                                }\n                            }\n                        }\n                        price_per_unit {\n                            base {\n                                currency_code\n                                currency_symbol\n                                effective\n                                marked\n                                selling_price\n                            }\n                            converted {\n                                currency_code\n                                currency_symbol\n                                effective\n                                marked\n                                selling_price\n                            }\n                        }\n                        product {\n                            attributes\n                            item_code\n                            name\n                            slug\n                            tags\n                            type\n                            uid\n                            brand {\n                                name\n                                uid\n                            }\n                            action {\n                                type\n                                url\n                            }\n                            categories {\n                                name\n                                uid\n                            }\n                            images {\n                                aspect_ratio\n                                secure_url\n                                url\n                            }\n                        }\n                        promo_meta {\n                            message\n                        }\n                        promotions_applied {\n                            amount\n                            article_quantity\n                            code\n                            meta\n                            mrp_promotion\n                            offer_text\n                            promo_id\n                            promotion_group\n                            promotion_name\n                            promotion_type\n                            applied_free_articles {\n                                article_id\n                                parent_item_identifier\n                                quantity\n                                free_gift_item_details {\n                                    item_brand_name\n                                    item_id\n                                    item_images_url\n                                    item_name\n                                    item_price_details {\n                                        currency\n                                        marked {\n                                            min\n                                            max\n                                        }\n                                        effective {\n                                            min\n                                            max\n                                        }\n                                    }\n                                    item_slug\n                                }\n                            }\n                            discount_rules {\n                                item_criteria\n                                matched_buy_rules\n                                offer\n                                raw_offer\n                            }\n                        }\n                        charges {\n                            meta\n                            name\n                            allow_refund\n                            code\n                            type\n                            amount {\n                                currency\n                                value\n                            }\n                        }\n                        coupon {\n                            code\n                            discount_single_quantity\n                            discount_total_quantity\n                        }\n                        identifiers {\n                            identifier\n                        }\n                        price {\n                            base {\n                                currency_code\n                                currency_symbol\n                                effective\n                                marked\n                            }\n                            converted {\n                                currency_code\n                                currency_symbol\n                                effective\n                                marked\n                            }\n                        }\n                        delivery_promise {\n                            formatted {\n                                max\n                                min\n                            }\n                            timestamp {\n                                max\n                                min\n                            }\n                            iso {\n                                max\n                                min\n                            }\n                        }\n                    }\n                    breakup_values {\n                        coupon {\n                            code\n                            coupon_type\n                            coupon_value\n                            description\n                            is_applied\n                            message\n                            minimum_cart_value\n                            sub_title\n                            title\n                            type\n                            uid\n                            value\n                        }\n                        display {\n                            currency_code\n                            currency_symbol\n                            display\n                            key\n                            message\n                            value\n                            preset\n                        }\n                        loyalty_points {\n                            applicable\n                            description\n                            is_applied\n                            total\n                        }\n                        raw {\n                            cod_charge\n                            convenience_fee\n                            coupon\n                            delivery_charge\n                            discount\n                            fynd_cash\n                            gift_card\n                            gst_charges\n                            mop_total\n                            mrp_total\n                            subtotal\n                            total\n                            vog\n                            you_saved\n                            total_charge\n                        }\n                    }\n                }\n            }\n        }\n    ",{buyNow:!1,areaCode:a,addCartRequestInput:{items:[{article_assignment:t.article_assignment,article_id:t.article_id,item_id:i,item_size:u,quantity:1,seller_id:t.seller.uid,store_id:t.store.uid}]}});console.log("Add to Cart Result:",r);const o=r?.data?.addItemsToCart||r?.addItemsToCart;o?.success?(await n.executeGQL("\n        query Cart($areaCode: String, $assignCardId: Int, $includeBreakup: Boolean, $buyNow: Boolean, $includeAllItems: Boolean, $includeCodCharges: Boolean, $cartId: String) {\n            cart(areaCode: $areaCode, assignCardId: $assignCardId, includeBreakup: $includeBreakup, buyNow: $buyNow, includeAllItems: $includeAllItems, includeCodCharges: $includeCodCharges, id: $cartId) {\n                buy_now\n                cart_id\n                checkout_mode\n                comment\n                coupon_text\n                delivery_charge_info\n                gstin\n                id\n                is_valid\n                message\n                restrict_checkout\n                user_cart_items_count\n                uid\n                success\n            }\n        }\n    ",{buyNow:!1,includeAllItems:!0,includeBreakup:!0}),await b(o.cart,t),alert("Product added to cart successfully!"),l(!1)):(console.error("Add to cart failed:",o),alert(`Failed to add product to cart: ${o?.message||"Unknown error"}`))}catch(e){console.error("Add to cart failed:",e),alert(`Failed to add product to cart: ${e.message}`)}finally{o(!1)}})(s,t)}catch(e){console.error("Serviceability check failed:",e),alert(`Failed to check serviceability: ${e.message}`),o(!1)}else alert("Please enter a valid 6-digit pincode")},disabled:t,className:r.confirmBtn},t?"Processing...":"Add to Cart"),i().createElement("button",{onClick:()=>l(!1),className:r.cancelBtn},"Cancel")))))}const c="query products($first: Int, $pageNo: Int, $enableFilter: Boolean, $pageType: String) {\n  products(first: $first, pageNo: $pageNo, enableFilter: $enableFilter, pageType: $pageType) {\n    items {\n      price {\n        effective {\n          currency_code\n          currency_symbol\n          max\n          min\n        }\n      }\n      media {\n        alt\n        type\n        url\n      }\n      slug\n      name\n      uid\n      embeddings\n      brand {\n        name\n        uid\n      }\n      categories {\n        name\n        uid\n      }\n    }\n  }\n}";function l({title:e="Extension Title Default"}){const n=(0,a.useFPI)(),t=(0,a.useGlobalStore)(n.getters.PRODUCTS),l=t?.items??[],[s,d]=(0,a.useState)([]),[u,m]=(0,a.useState)({}),[p,_]=(0,a.useState)(null);return(0,a.useEffect)((()=>{if("undefined"!=typeof window){const e=window.location.pathname.split("/product/")[1];_(e)}}),[]),(0,a.useEffect)((()=>{console.log("recommendedBundles",u),console.log("formattedSlug",p)}),[u,p]),(0,a.useEffect)((()=>{l.length?d(l):(async()=>{let e=[],t=1,a=!0;for(;a;){const i={enableFilter:!0,first:50,pageNo:t,pageType:"number"};try{const r=await n.executeGQL(c,i),o=r?.products?.items||[];e=[...e,...o],o.length<50?a=!1:t++}catch(e){console.error("Failed to fetch products:",e),a=!1}}return d(e),n.custom.setValue(n.getters.PRODUCTS,{items:e}),e})().then((e=>{d(e)}))}),[l.length,n]),(0,a.useEffect)((()=>{p&&s.length>0&&(async(e=s)=>{const n=e.find((e=>e.slug===p));console.log("targetProduct",n);const t={company_id:10368,slug:n.slug};console.log("Request Data:",t);const a={"Content-Type":"application/json"};try{const e=await fetch("https://asia-south1.workflow.boltic.app/a5d3c126-e0e7-4228-bc1f-86ba7d93dfb5/bundling",{method:"POST",headers:a,body:JSON.stringify(t)});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const n=await e.json();console.log("Response:",n),m(n.recommended_bundles)}catch(e){console.error("Request failed:",e)}})(s)}),[p,s]),s.length?i().createElement("div",{className:r.maincontainers},i().createElement(a.Helmet,null,i().createElement("title",null,e)),i().createElement("h2",{className:r.lookText},"Complete the look"),i().createElement("br",null),i().createElement("div",{className:r.bundlings}),i().createElement("div",{className:r.bundles},u?.target&&i().createElement(i().Fragment,null,s.filter((e=>e.slug===u.target.slug)).map((e=>i().createElement(o,{product:e,key:e.slug,fpi:n}))),u.recommended_outfits?.map(((e,t)=>{const a=e[0],r=s.find((e=>e.slug===a.slug));return r?i().createElement(o,{product:r,key:r.slug,fpi:n}):null}))))):i().createElement("h2",null,"Loading Products...")}l.serverFetch=({fpi:e})=>(e.custom.setValue("test-extension",!0),e.executeGQL(c,{enableFilter:!0,first:50,pageNo:1,pageType:"number"}));const s={label:"Product List",name:"product-list",props:[{id:"title",label:"Page Title",type:"text",default:"Extension Title",info:"Set the page title for the product list."}],blocks:[]},d={"product-list":{...t}};exports.sections=n})();