!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("React"),require("helmetModule"),require("sharedUtilsLibrary")):"function"==typeof define&&define.amd?define("extension",["React","helmetModule","sharedUtilsLibrary"],t):"object"==typeof exports?exports.extension=t(require("React"),require("helmetModule"),require("sharedUtilsLibrary")):e.extension=t(e.React,e.helmetModule,e.sharedUtilsLibrary)}("undefined"!=typeof self?self:this,((e,t,r)=>(()=>{"use strict";var n={173:e=>{e.exports=r},333:e=>{e.exports=t},883:t=>{t.exports=e}},o={};function a(e){var t=o[e];if(void 0!==t)return t.exports;var r=o[e]={exports:{}};return n[e](r,r.exports,a),r.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};a.r(i),a.d(i,{default:()=>h});var l={};a.r(l),a.d(l,{Component:()=>g,settings:()=>y});var s=a(883),c=a.n(s),u=a(173),d=a(333);const p={productCard:"dPLAA",productImage:"ZzT3G",productName:"p1x2t",productSlug:"wBYiF",priceSection:"NqWXr",price:"q7Ot2",originalPrice:"fwdqk",discount:"XV4Fd",recommendationTitle:"i3TxS",recommendationGrid:"OG8Qe",mainProduct:"yQ0RN"};function m({product:e}){const t=e.price?.effective?.min,r=e.price?.effective?.max,n=e.price?.effective?.currency_symbol||"$",o=r&&t&&r>t?Math.round((r-t)/r*100):null;return c().createElement("div",{className:p.productCard,onClick:()=>{console.log("Clicked on:",e.name),e.slug&&(window.location.href=`/product/${e.slug}`)},style:{cursor:"pointer"}},e.media?.[0]&&c().createElement("img",{src:e.media[0].url,alt:e.media[0].alt,className:p.productImage}),c().createElement("h3",{className:p.productName},e.name),c().createElement("div",{className:p.priceSection},c().createElement("span",{className:p.price},n,t),o&&c().createElement(c().Fragment,null,c().createElement("span",{className:p.originalPrice},n,r),c().createElement("span",{className:p.discount},"-",o,"%"))))}const f="query products($first: Int, $pageNo: Int, $enableFilter: Boolean, $pageType: String) {\n  products(first: $first, pageNo: $pageNo, enableFilter: $enableFilter, pageType: $pageType) {\n    items {\n      price {\n        effective {\n          currency_code\n          currency_symbol\n          max\n          min\n        }\n      }\n      media {\n        alt\n        type\n        url\n      }\n      slug\n      name\n      description\n      tags\n    }\n  }\n}";function g({title:e="Extension Title Default"}){const t=(0,u.useFPI)(),r=(0,u.useGlobalStore)(t.getters.PRODUCTS),n=r?.items??[],[o,a]=(0,s.useState)([]),[i,l]=(0,s.useState)([]),[g,y]=(0,s.useState)(null);return(0,s.useEffect)((()=>{if("undefined"!=typeof window){const e=window.location.pathname.split("/product/")[1];y(e)}}),[]),(0,s.useEffect)((()=>{n.length?l(n):(async()=>{let e=[],r=1,n=!0;for(;n;){const o={enableFilter:!0,first:50,pageNo:r,pageType:"number"};try{const a=await t.executeGQL(f,o),i=a?.products?.items||[];e=[...e,...i],i.length<50?n=!1:r++}catch(e){console.error("Failed to fetch products:",e),n=!1}}return l(e),t.custom.setValue(t.getters.PRODUCTS,{items:e}),e})().then((e=>{l(e)}))}),[n.length,t]),(0,s.useEffect)((()=>{g&&i.length>0&&(async(e=i)=>{const t={company_id:10368,slug:e.find((e=>e.slug===g)).slug},r={"Content-Type":"application/json"};try{const e=await fetch("https://asia-south1.workflow.boltic.app/ca7a0558-f634-4c93-872f-4e5b63e30f10/recommendation",{method:"POST",headers:r,body:JSON.stringify(t)});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const n=await e.json();console.log("Response:",n),a(n.recommendations)}catch(e){console.error("Request failed:",e)}})(i)}),[g,i]),i.length?c().createElement("div",null,c().createElement(d.Helmet,null,c().createElement("title",null,e)),c().createElement("h2",{className:p.recommendationTitle},"You might also like"),c().createElement("div",{className:p.recommendationGrid},i.filter((e=>o.includes(e.slug))).map((e=>c().createElement(m,{product:e,key:e.slug}))))):c().createElement("h2",null,"Loading Products...")}g.serverFetch=({fpi:e})=>(e.custom.setValue("test-extension",!0),e.executeGQL(f,{enableFilter:!0,first:50,pageNo:1,pageType:"number"}));const y={label:"Product List",name:"product-list",props:[{id:"title",label:"Page Title",type:"text",default:"Extension Title",info:"Set the page title for the product list."}],blocks:[]},h={"product-list":{...l}};return i})()));